<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="hotdog.commons.upload.dao.UploadDao">

	<select id="selectUploadList" parameterType="map" resultType="egovMap">
		SELECT  /* sqlMapId(UploadDao.selectUploadList) */
		        A1.FILE_SEQ,
		        A1.FILE_ID,
		        A1.ORIGINAL_FILE_NAME,
		        A1.STORED_FILE_NAME,
		        A1.FILE_PATH,
		        A1.FILE_SIZE
		 FROM  	ATTACH_FILE			A1
		 <where>
			<if test="null != fileId and '' != fileId">
		 AND 	A1.FILE_ID	= 	#{fileId}
			</if>
		 </where>
		 ORDER BY
	            A1.FILE_SEQ
   	</select>

    <insert id="insertUpload" parameterType="egovMap">
        <selectKey keyProperty="fileSeq" resultType="string" order="BEFORE">
            SELECT COALESCE(MAX(FILE_SEQ), '0') + 1 FROM ATTACH_FILE
        </selectKey>
        INSERT INTO ATTACH_FILE
        VALUES
        (
	        #{fileSeq},
	        #{fileId},
	        #{originalFileName},
	        #{storedFileName},
	        #{filePath},
	        #{fileSize}
        )
    </insert>
    
    <delete id="deleteUpload" parameterType="egovMap">
    	DELETE
    	FROM	ATTACH_FILE
    	WHERE 	FILE_SEQ 	= 	#{fileSeq}
    </delete>
</mapper>